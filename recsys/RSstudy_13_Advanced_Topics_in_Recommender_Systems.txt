
13.1 Introduction

추천시스템은 이전의 장에서 다루어지지 않은 특화된 환경에서 사용됨. 많은 경우에, 수많은 사용자 혹은 여러 평가 기준이 있는 환경에서 추천이 이루어 짐. 
예를 들어, 한 그룹의 여행자가 휴가를 함께 보내고 싶은 경우를 생각해보자. 그러므로, 그룹 내의 다양한 멤버들의 전체적인 관심을 충족시킬 추천을 얻고싶을 것임. 다른 시나리오에서는, 사용자가 아이템에 평점을 제공할 때 다양한 기준을 사용할 수 있음.
이러한 변형된 문제들은 예측 문제를 더 어렵게 만들 수 있음. 특히, 다음과 같은 진보된 변형을 이 장에서 다루어 볼 것.

1. Learning to rank(순위법 학습): 이전에 다루어진 대부분의 모델은 추천 문제를 평점 예측의 문제로 다룸. 평점의 제곱오차가 최소화되도록 학습함.
그러나 실제 환경에서는, 유저는 상위 k개의 제품만을 제공받으며, 다른 예측값은 무시됨.
그러므로, 평균적인 상호 순위(MRR) 혹은 ROC 곡선의 AUC 값과 같은 순위 기반 평가 기준을 직접적으로 최적화할 수 있을지를 탐구하는 것이 더 타당해 보임. 

2. Multi-armed Bandit을 사용한 온라인 학습: 뉴스 기사 추천과 같은 많은 추천 도메인에서, cold-start 문제는 어디에나 존재함. 새로운 기사와 이야기는 항상 등장하는데, 다양한 알고리즘의 효율성은 시간에 따라 변화하기 마련임.
이런 경우에, 새로운 데이터가 들어왔을 때 계속적으로 다양한 선택의 공간을 탐색(Explore)하는 접근이 매우 중요함. 동시에, 학습된 데이터는 전환율의 관점에서 성과를 올리기 위해 활용(Exploit)되어야 함.
MAB(Multi-armed bandit) 알고리즘을 통해, 이러한 탐색(Exploration)과 탐험(Exploitation)의 trade-off가 관리될 수 있음.

3. 그룹 추천 시스템: 많은 상황에서, 추천은 개인을 위해서 이루어지지 않고 유저의 그룹을 위해 이루어 짐. 이런 추천은 전형적으로 유저 그룹에 의해 취해진 행동과 연관되어 이루어짐.
한 그룹에 의해 접근된 영화, 그룹에 의해 구매된 여행 서비스, 그룹에 의해 재생된 영화 혹은 TV 프로그램의 선택 등등이 예시에 포함된다.
이러한 경우에서는, 사용자들의 취향과 관심이 각기 다른 선택에 반영된다. 그룹 추천 시스템은 유의미한 추천을 제공하기 위해 이 같은 다양한 trade-off를 잘 다룰 수 있도록 고안됨.

4. 다기준 추천 시스템: 다기준 시스템에서는, 평점은 한 유저에 의해 다른 기준에 근거하여 상세될 것임. 예를 들어, 한 영화에 대해 줄거리,음악, 특수효과 등의 기준으로 평점을 내릴 수 있음.
이런 기법들은 다양한 기준에 따른 평점의 벡터로 한 아이템에 대한 유저의 효용을 모델링함으로써 추천을 제공함.
사실상, 그룹 추천 시스템에 적용된 몇몇 방법론들이 다기준 추천 시스템에 적용될 수 있음이 알려졌다. 그러나, 이 두 주제는 일반적으로 다르다고 간주되는데, 그 이유는 추천 프로세스의 다른 측면을 강조하기 때문임.

5. 추천시스템의 능동 학습: 능동 학습은 널리 알려짐 기법으로, 분류 문제에서 학습 샘플의 라벨을 얻어 분류 정확도를 극대화하는 방법임.
라벨의 획득은 일반적으로 비용이 많이 듦. 그러므로, 사용자는 주어진 비용 예산 한에서 정확도를 극대화하기 위해 학습 샘플을 신중하게 선택해야 함.
추천의 문제가 분류의 일반화된 문제로 볼 수 있는 만큼, 능동 학습의 가용한 방법론들은 추천 문제에도 일반화될 수 있음.
능동 학습은 예측 정확도를 극대화하기 위해 주어진 예산 한에서 평점을 획득하는 방법을 제공함.

6. 추천 시스템에서의 사생활 보호: 추천시스템은 그들의 관심사에 대한 정보를 자발적으로 제공하는 유저의 능력에 깊이 의존하고 있음.
이런 정보는 상당히 민감한데, 이는 정치적인 의견, 성적 지향 등에 대한 민감한 정보를 노출할 수 있기 때문.
그러므로, 추천시스템 과정을 위해 사생활을 보호하는 방법을 개발하는 것은 매우 중요함. 공공에의 노출 위험이 있는 경우, 평점 데이터의 소유자는 이를 표현하려 들지 않을 것임.
넷플릭스 프라이즈의 경우의 예시가 있는데, 이 대회의 후속이 사생활 침해 문제로 더 이상 이어지지 않았음.

앞에 언급된 주제에 더해, 이 챕터는 다양한 활용 도메인에의 추천 시스템 기술의 응용을 보여줄 것. 가령 뉴스 추천, 계산적 광고, 상호적 추천 시스템 등을 포함함.
이러한 토픽을 연구하는 것은 이전에 논의된 방법론들이 이러한 다른 도메인에 적용되는지를 이해하는 법을 제공해 줌.
몇몇 경우에는, 이러한 챕터에서 논의된 기법들은 직접적으로 적용될 수 없어, 새로운 방법이 개발되어야 함.
그러므로, 우리의 목적 중 하나는 현재 상황에서 사용되는 다양한 방법론의 한계점에 대한 이해를 제공하는 것임.



13.2 Learning to Rank (순위법 학습)
앞서 등장한 대부분의 모델은 평점 예측의 제곱 오차가 최적화되는 예측 모델로써 추천 문제를 바라봄.
그러나 실제에서는, 유저에 대해 모든 평점이 보여지는 경우는 거의 없음.
실제로는, 오직 상위 k개의 아이템만이 순위 매겨진 리스트로써 유저에게 보여짐.
게다가, 하위 평점을 받은 아이템보다는 리스트 상위에 등장하는 아이템에 관심을 기울일 확률이 더 높음.

리스트에 포함되지 않은 아이템에 대해 예측된 값은 유저 관점에서는 무관함. 
많은 경우에, 평점의 예측 값을 최적화 하는 것은 말단 유저에게 최소의 추천 리스트를 제공하지는 않음.
예를 들어, 모든 후 순위에 랭크된 평점들이 아주 정확하게 예측 되었어도, 상위 순위의 평점에 유의한 에러가 발생한다면, 결과로 나온 해결책은 고품질의 추천 리스트가 되지는 않을 것.

반면에, 예측 기반 목표 함수는 고품질의 솔루션으로 이를 보고하는데, 이는 하위 순위의 상품들이 동등한 중요도를 부여받기 때문.
이 문제는 예측 기반 방법의 목표 함수는 말단 유저의 경험과 완전히 일치되지 않기 때문에 발생함.

추천 시스템(Matrix Factorization 등)의 모델 최적화에 사용되는 고전적인 목표 함수는 통합 제곱 오차임.
이 타입의 목표함수는 추천 시스템의 평가를 위해 사용되는 RMSE 측도에 최적화 됨. 이는 알고리즘 측면에서 최적화하기 특히 쉬움.
예측 기반 목표 함수가 추천 모델링 관점에서 우세한 데에는, 이러한 용이성도 일조함.
그러나, 7장의 추천 시스템 평가에서 논의 했듯이, 추천 시스템을 평가할 많은 랭크 중심 측도들이 있음.
이러한 랭크 중심 측도는 직접적으로 협업 필터링 모델(콘텐츠 기반 모델링에서도)의 맥락에서 최적화될 수 있음.
7장에서 다뤘듯이, 2개의 주요한 랭킹 측도 타입이 있음.

1. 전역적 순위 측도: 이러한 측도는 모든 아이템의 전체 순위된 리스트를 평가함.
예를 들어, kendall 계수, 스피어만 계수, ROC 커브의 AUC 등을 포함함.

2. 상위-가중 순위 측도: 이 측도들은 전형적으로 상위 랭크된 상품들이 더 높은 중요도를 갖는 효용 기반의 측도임.
이런 측도의 예시들은 표준화 누적 할인 이득(NDCG)와 평균 상호 순위 (MRR)을 포함함.
이 측도들은 보통 말단 유저 관점에서 가장 현실적인 측도인데, 이는 하위 순위의 아이템을 배제하기 때문임.
이러한 상품을은 추천시스템에서 말단 유저에게 보이지 않음.

많은 순위 기반 측도들이 암시적 데이터 상황을 평가하는 데 사용됨. 따라서, 많은 순위 기반 학습 방법론이 암시적 데이터 상황의 맥락에서 고안되었음.

예를 들어, 평점 행렬 R을 user/item factor U,V로 각각 factorizing하는 문제를 생각해보면, U,V를 특정 순위 목표가 최적화 되로록 결정하고 싶을 것임.
그렇다면, 최적화 문제를 다음과 같이 제시할 수 있음.
J를 최적화 R과 UV^T 간의 ranking 평가를 정량화하는 목표함수로 놓고, 이를 최적화하는데 U와 V라는 제약조건에 종속하도록 만듦.

전통적인 MF에서와 같이, 정규화 조건을 더해 목표 함수의 일반화 성능을 향상시킬 수 있음.
U와 V에 가해진 제약조건은 특정 응용 상황에 달려있을 것임.
예를 들어, 암시적 피드백 상황에서는, 비음수 제약을 U와 V에 부여할 수 있음.

최적화 목적 함수는 NDCG, MRR, AUC와 같은 순위 기반 측도에서 유래했을 것임.
이런 MF 방식의 특정 예시인, AUC를 최적화하는 방식은, [432]에서 논의되었음.

이 작업에서, AUC기반 목적 함수를 사용해 link 추천 문제가 해결되었음. 
핵심적인 난점은 순위 기반 방법론은 기저의 목적 함수가 보통 non-smooth하다는 점인데, 이는 흔히 사용하는 경사하강 방식을 사용해 최적화하기 힘들다는 점임.

예측 평점의 미세한 변화는 아이템 순위를 바꿀 수 있고, 따라서 목적 함수를 갑자기 변화시킬 수 있음.
예를 들어, 네로와 글레디에이터라는 두 영화가 있을 때, 실 평점이 0과 1이라고 해보자.
다양한 조합의 예측 평점에 대한 (smooth한) RMSE는 완만한 경사를 갖는 곡면을 그리는 반면, top-1 예측 평점의 (non-smooth한) 예측률은 수직 경사를 나타냄.
후자의 경우에서, 예측 평점의 특정 값에서 등장하는 목표 함수의 수직 도약에 주목하라.

순위 기반 목표 함수의 경우에서, 이러한 nonsmooth한 도약 혹은 수직 경사는 예측값의 작은 변동에 발생할 뿐만 아니라, 기저의 모델 파라미터의 작은 변화에도 발생함.
예를 들어, MF 방법에서, 유저와 아이템 요소들의 파라미터가 아주 작게 변화해도 급격한 도약 혹은 하강을 순위 기반 목표 함수에서 야기할 수 있음.

이러한 non-smooth한 변화는 제곱 오차와 같은, 고전적이고 최적화하기 훨씬 쉬운 측도에서는 관찰되지 않음.
예를 들어, 경사하강법은 적절한 하강 방향을 이러한 non-smooth한 목표 함수에서 찾기 어려울 것임. 왜냐하면 목표 함수에서의 중요한 변화는 변수 공간에서 미분 불가능한 지점에서 발생할 수 있기 때문임.
이 문제를 다루기 위해, 잠재된 목표 함수의 smooth한 근사 방식이 종종 사용됨.
각각 개인의 순위 기반 목표함수에는, 잠재된 목표 함수의 smooth한 변형을 설계하기 위해 특정 하한선 혹은 근사 방식이 사용됨.
이러한 smooth한 변형은 단지 근사이기 때문에, 알고리즘의 품질은 잠재된 근사 방식에 달려있고는 함.
다음으로, 순위 기반 방식의 일부에 대한 간단한 논의를 제공할 것.

순위에 대한 전통적인 접근은 손실 함수와 함께 평점을 먼저 예측하고, 아이템을 이 예측된 평점에 기반해 순위를 매기는 것임.
이 접근법을 pointwise 방법론이라 할 수 있음.
이러한 방법론의 많은 예시들은 순위에만 특별히 최적화되지는 않는데, 이는 평점 값의 예측에 중점을 맞추기 때문임.
이 카테고리의 특히 주목할만한 연구는 OrdRec인데, 이는 평점을 수치값이 아닌 서수 값으로 간주함.
순위 중심 학습에서 최적화되는 두가지 주요한 타입의 방법론이 있는데, 이들은 
"pairwise" 혹은 "listwise" 순위 학습 방법론으로 일컫어짐.
이제, 다른 타입의 순위 학습 방식을 다루어 보려고 함.



13.3 Multi-Armed Bandit Algorithms 

많은 추천 상황에서의 중요한 난점은, 새로운 유저와 아이템이 항상 시스템에 등장하며,
추천시스템은 항상 데이터의 변화하는 패턴에 적응할 줄 아는 것이 중요함.
그러므로, 오프라인 추천 알고리즘과는 달리, 이 접근은 추천의 탐색 공간 내에서 탐색과 활용을 동시에 이루어 내야함.
매 시간마다 추천을 유저에게 보여줄 기회가 발생하는데, 추천 시스템은 유저에게 보여질 것을 결정하는 수많은 전략과, 목적과, 알고리즘을 선택해야 함.

이러한 선택들은 다루고 있는 응용 도메인에 따라 다를 수 있다.
아래는 몇몇 예시들임:

1. 시스템은 수 만은 다른 추천 알고리즘을 사용할 수 있음. 이는 많든 적든 간에 다른 유저들에게 효과적일 수 있음. 예를 들어, 고도의 customization을 선호하는 한 유저는 knowledge-based 추천 시스템에 더 적합할수도 있고,
반면에 게으른 유저는 CF 알고리즘으로 추천을 제공하는 것이 대부분의 경우에 적합할 것임.
그러므로, 이러한 접근은 항상 각 유저에 대해 최적의 전략을 선택하는 법을 배워야 함.

2. 앞서 언급한 상황의 특수한(그리고 중요한) 사례는 각 전략이 특정 상품을 추천하는 상황임.
예를 들어, 뉴스 포털이 다양한 토픽의 아티클을 특정 유저에게 일정 기간에 걸쳐 보여주고, 다양한 아티클에 대한 과거의 관심 기록에 따라 아티클 제공을 달리할 수 있을 것.
맥락이 없는 상황에서, 추천은 유저에 대해 독립적임.
그러나, 현실에서는, 특성 벡터가 각 유저에 따라 관련지어지고, 이는 특정 토픽에 대한 유저의 관심을 특성지음.
이는 MAB 알고리즘에서 개인화를 통합할 방법을 제공함
만약 유저가 스포츠와 예능에 더 관심이 많다면, 추천시스템은 이 사실을 시스템 작동 시간동안 학습하여, 해당 개인에게 이러한 토픽들에 속하는 추천을 주기적으로 보여줌.

이러한 시스템의 주된 난점은 새로운 유저와 새로운 기사가 시스템에 항상 들어온다는 것임.
그러므로, 시스템은 작동 기간동안 유저의 관심을 학습하고 이러한 관심을 활용하는 것을 동시에 수행해야함.
이는 이 책에서 언급된 오프라인 환경과는 다름. 이 문제는 강화학습의 상황과 관련이 있는데, 이는 탐색 공간에서의 탐색과 활용이 동시에 이루어지는 상황을 말함.
이런 강화학습의 중요한 클래스가 MAB의 그것과 같음.

이러한 알고리즘의 클래스는 추천 시스템을 카지노 안의 도박꾼과 비슷한 방식으로 볼 수 있다는 사실에서 유래되었음.
이 도박꾼은 수많은 슬롯머신(추천 알고리즘 혹은 전략) 중 하나를 선택해야하는 문제에 당면함.
도박꾼은 특정 확률 분포에 따른 보상을 받게될 것이고, 한 특정 슬롯 머신이 더 높은 (기대) 수익을 다른 슬롯 머신보다 더 가져다 준다고 의심할 것. (비록 모든 기계를 돌려보기 전까지는 확인할 수 없는 방법이지만)

이러한 기계들을 학습 목적으로 작동하는 것은 검색 공간의 전략을 탐색하는 것으로 볼 수 있음.
물론, 이러한 학습 단계는 시도를 낭비할 수 있음. 왜냐면 가장 좋은 결과를 주는 기계에 최적화되지 않았기 때문.
그러나, 도박꾼이 기계 중 하나가 더 나은 보상을 준다는 것을 안 순간, 그는 그 기계를 더 나은 보상을 얻기 위해 작동할 수 있음.
강화학습 알고리즘처럼, MAB 알고리즘은 탐색 공간 내에서 탐색과 활용의 자연스러운 trade-off를 마주하게 됨.


13.4 Group Recommender Systems

그룹 추천 시스템은 상품이 그룹의 유저들에 의해 소비될 경우를 위해 고안됨. 이러한 시나리오의 몇몇 예시와 시스템들은 다음과 같은 문제를 해결하기 위해 개발됨
1. 영화 도메인: 많은 경우에, 유저 그룹이 한 집합의 영화를 보러 나가고자 하려함. 추천은 그러므로 이 그룹의 소비에 맞춰져야 함. 이러한 추천 시스템의 예시는 PolyLens가 있음.
이는 유저 그룹에 맞는 추천을 제공함. PolyLens는 MovieLens 시스템의 확장으로 볼 수 있음.

2. 텔레비전 도메인: 영화처럼, 그룹 단위 유저들이 함께 볼 프로그램을 추천하고자 할 수 있음. 일례로, TV 프로그램 추천 시스템에서 유저 프로필을 통합하는 방식을 사용.

3. 음악 도메인: 음악을 그룹으로 함께 듣는 것은 덜 흔하겠지만, 이러한 상황은 피트니스 센터 혹은 체육관 등에서처럼 음악이 그룹 환경에서 재생될 때 발생함. 
이러한 시스템의 예시는 MusicFX 그룹 추천 시스템이 있음.

4. 여행 도메인: 여행 도메인은 그룹 추천의 가장 흔한 형태일 것임. 이는 그룹 단위 여행객이 여행 계획을 함께 짜는 것이 흔하기 때문임.
몇몇 예시는 Intrigue, Travel Decision Forum, Collaborative Advisory Travel System(CATS) 등을 포함함.
이러한 절차는 자연스러운 질문을 낳음: 왜 이러한 상황에서 추천 상품들을 직접 평균을 내지 않는가?
무엇보다, 전체 효용을 극대화하는 것이 목표라면, 평균을 사용하는 것이 가장 효율적인 선택지일 것임.
그러나, 사회 현상에 기반하여 사용자들은 서로에게 영향을 미침. 가령 감정적 전염, 순응 등이 있음.

이 현상은 다음과 같이 정의됨.
1. 감정적 전염: 다양한 유저의 만족은 다른 이들에게 영향을 미칠 수 있음.
예를 들어, 유저 집단이 영화를 함께 본다면, 그리고 몇 멤버가 영화를 재미없어 한다면, 다른 이들에게 전염적인 영향을 미칠 수 있음.
이런 경우에, 평균 내는 방식은 잘 작동하지 않을 것임. 왜냐하면 재미 없어하는 유저들이 다른 이들의 취향을 감염시킴으로써 그룹의 최종 경험이 단순히 평균을 낸 평점이 암시하는 것과는 달라질 것이기 때문.

2. 순응: 순응은 감정적 감염의 개념과 밀접히 연관되어 있는데, 유저의 표현된 의견이 다른 이들에게 영향을 미친다는 점에서 그렇다.
그러나, 사회적 현상은 미묘하게 다른데, 의식적으로 비슷한 의견을 동료들과 가지기를 원한다는 점에서(의견의 숨은 차이점이 있음에도 불구하고) 그러함.
혹은 그들의 의견은 무의식적으로 동료의 영향에 의해 바뀜. 결과적으로, 그룹의 최종적인 경험은 평균 평점이 의미하는 것보다 유의미하게 달라질 수 있음.

이 두 사회 선택 이론에 관련된 사회적 현상은, 추천 시스템의 성능에 막대한 효과를 가짐. 결과적으로, 평균 내기 전략은 잘 작동하지 않음.
예를 들어, TV프로 추천 서비스에서 평균 기반 전략을 평가한 경우, 균일한 취향을 가진 경우에 잘 작동하는 것을 보였지만 이질적인 취향을 가진 그룹의 경우 잘 작동하지 않음.

그러므로, 사회적 현상을 모델링 단계에서 활용하는 것이 중요함. 추가적으로, 그룹 추천 시스템은 일반적으로 그 시스템이 Collaborative인지, 컨텐트 베이스인지, knowledge-base 인지에 따라 다르게 정의됨.
CF와 컨텐트 기반 상황에서는 그룹 추천 시스템의 일반적인 원칙은 유사하지만, Knowledge-based 시스템은 상당히 다름. 이 다른 상황에 대해 학습해 봄.
 

13.5 Multi-Criteria Recommender Systems

많은 추천 응용에서, 유저는 다른 기준에 근거하여 상품에 관심을 가지게 될 것임.
예를 들어, 영화 추천 시스템에서, 유저는 시각 효과에 관심이 있을 수 있고, 다른 유저는 줄거리에 관심을 가질 수도 있음. 가설적인 예시를 생각해보자.

이 경우에, 3명의 유저가 그들의 평점을 글래디에이터에 대해 시각 효과, 줄거리, 전체평가에 대해 내렸다고 해보자.
전체 평가는 유저에 의해 직접적으로 상술되며, 모든 평점의 평균을 꼭 나타낼 필요는 없음. 각 평점은 1~10의 척도에서 제시됨.

앨리스와 사야니가 정확히 같은 전체 평가를 내렸지만, 줄거리와 시각 효과에 대한 평가는 매우 다름.
반면에, 앨리스와 밥은 전체 평점은 다소 다르지만, 시각 효과와 줄거리에 대해 비슷한 평가를 내림.

그러므로, 어느 동료 기반 예측 방법이든, 앨리스와 밥은 앨리스와 사야니보다 더 유사할 것으로 간주되어야 함.
유사도 계산을 전체 평점에 대해 수행한다면, 잘못된 예측을 내릴 수 있음.

다기준 시스템의 전체 평가는 명시적으로 유저에 의해 표현될 수 있고, 혹은 전역적 효욜 함수 (단순 평균과 같은)를 사용함으로써 도출될 수 있음.
전체 평가가 유저에 의해 상술될 경우, 유저 특화 효용 함수를 선형 회귀 방식을 사용해 학습할 수 있음. (5장 knowledge-based recsys에서 다룸)

전체 평가가 유저에 의해 상술되지 않은 경우, 전체 평가를 계산하지 않고 다양한 기준의 예측값을 통합함으로써 직접적으로 아이템이 순위매겨질 수 있음.

다른 경우에는, 전체 평가를 만들기 위해 다양한 기준에 대해 평균을 암묵적으로 낼 수 있음. 
필요시, 다양한 기준이 도메인 특화된 지식(예를 들어, 효용 함수)을 사용해 가중될 수 있음.

다기준 추천 시스템은 본질적으로 knowledge-based system이라는 것을 지적해야하는데, 이는 차량과 같은 복잡한 상품 도메인에서 고안되는 방식임.
이러한 상품들은 성능, 내부 디자인, 고급 옵션, 네비게이션 등의 다양한 기준을 가짐. 
이런 도메인에서는, 유저는 아이템이 유저가 특정한 기준을 만족시키는지 여부에 따라 아이템을 순위 매기길 원함.
이런 방법이 5장에서 이미 논의 되었기 떄문에, 이 장에서는 우선적으로 컨텐트 기반, CF 기반 방법에 집중할 것.
다음으로는, 다기준 추천 시스템에서 흔히 사용되는 방법에 대해 의논할 것. 최신 방법론의 최신 논의를 보고자 하면, bibliographic notes를 참고하라.



